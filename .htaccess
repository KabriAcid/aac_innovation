RewriteEngine On
RewriteBase /aac_innovation/

# API requests - do not rewrite
RewriteCond %{REQUEST_URI} ^/aac_innovation/backend/api/
RewriteRule ^ - [L]
RewriteCond %{REQUEST_URI} ^/aac_innovation/api/
RewriteRule ^api/(.*)$ backend/api/$1 [L,QSA]

# Skip rewrite for real files and directories
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# Serve static files from dist
RewriteCond %{DOCUMENT_ROOT}/aac_innovation/dist%{REQUEST_URI} -f
RewriteRule ^(.*)$ dist/$1 [L]

# Redirect root and /aac_innovation to dist/index.html
RewriteCond %{REQUEST_URI} ^/aac_innovation/?$
RewriteRule ^$ dist/index.html [L]

# Fallback to dist/index.html for SPA routes
RewriteRule ^ dist/index.html [L]